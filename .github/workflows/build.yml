name: CI
on:
  push:
    branches:
      - 'master'
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@master

    - uses: actions/setup-node@v1
      with:
        node-version: '12'

    - name: "npm install"
      run: npm ci

    - name: "Lint scss"
      run: npm run lint:scss

    - name: "Lint js"
      run: npm run lint:js
    
    - name: "Build js,css"
      run: npm run build

    - name: "Create theme bundle"
      run: npm run bundle

    # - name: Deploy Plugins to WP Server
    #   uses: appleboy/scp-action@master
    #   with:
    #     username: ${{ secrets.DEPLOYMENT_USER }}
    #     host: ${{ secrets.DEPLOYMENT_HOST }}
    #     key: ${{ secrets.DEPLOYMENT_KEY }}
    #     source: "bundle.zip"
    #     target: "/tmp"
    #     port: 22

    # - name: Install plugin using Wordpress cli over ssh
    #   uses: appleboy/ssh-action@master
    #   with:
    #     username: ${{ secrets.DEPLOYMENT_USER }}
    #     host: ${{ secrets.DEPLOYMENT_HOST }}
    #     key: ${{ secrets.DEPLOYMENT_KEY }}
    #     port: 22
    #     script: |
    #       sudo wp theme install /tmp/bundle.zip \
    #         --activate \
    #         --allow-root \
    #         --path=/var/www/html \
    #         --force

